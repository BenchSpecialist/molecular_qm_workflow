# required model configuration for AIMNet2
class: mqc_pipeline._aimnet.aimnet2.AIMNet2
kwargs:
    nfeature: 16
    d2features: true
    ncomb_v: 12
    hidden:
        - [512, 380]
        - [512, 380]
        - [512, 380, 380]
    aim_size: 256
    aev:
        rc_s: 5.0
        nshifts_s: 16
    extra_passes: 1  # Added extra passes parameter
    outputs:
        energy_mlp:
            class: mqc_pipeline._aimnet.core.Output
            kwargs:
                n_in: 256
                n_out: 1
                key_in: aim
                key_out: energy
                mlp:
                    activation_fn: torch.nn.GELU
                    last_linear: true
                    hidden: [128, 128]

        atomic_shift:
            class: mqc_pipeline._aimnet.core.AtomicShift
            kwargs:
                key_in: energy
                key_out: energy

        atomic_sum:
            class: mqc_pipeline._aimnet.core.AtomicSum
            kwargs:
                key_in: energy
                key_out: energy

        lrcoulomb:
            class: mqc_pipeline._aimnet.lr.LRCoulomb
            kwargs:
                rc: 4.6
                key_in: charges
                key_out: energy

        electronic_levels:
            class: mqc_pipeline._aimnet.enhanced_output.EnhancedElectronicLevelsOutput
            kwargs:
                n_in: 256
                key_in: aim_enhanced_electronic
                mlp:
                    hidden: [512, 256, 128]
                    activation_fn: torch.nn.SiLU
                    dropout: 0.1
                    last_linear: true

        esp_levels:
            class: mqc_pipeline._aimnet.enhanced_output.EnhancedESPOutput
            kwargs:
                n_in: 256
                key_in: aim_enhancedesp
                mlp:
                    hidden: [512, 256, 128]
                    activation_fn: torch.nn.SiLU
                    dropout: 0.1
                    last_linear: true
